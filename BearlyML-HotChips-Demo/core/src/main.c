/* USER CODE BEGIN Header */
/**
 ******************************************************************************
 * @file           : main.c
 * @brief          : Main program body
 ******************************************************************************
 * @attention
 *
 * This software is licensed under terms that can be found in the LICENSE file
 * in the root directory of this software component.
 * If no LICENSE file comes with this software, it is provided AS-IS.
 *
 ******************************************************************************
 */
/* USER CODE END Header */
/* Includes ------------------------------------------------------------------*/
#include "main.h"

/* Private includes ----------------------------------------------------------*/
/* USER CODE BEGIN Includes */

/* USER CODE END Includes */

/* Private typedef -----------------------------------------------------------*/
/* USER CODE BEGIN PTD */

/* USER CODE END PTD */

/* Private define ------------------------------------------------------------*/
/* USER CODE BEGIN PD */
/* USER CODE END PD */

/* Private macro -------------------------------------------------------------*/
/* USER CODE BEGIN PM */

#define STR1(x) #x
#ifndef STR
#define STR(x) STR1(x)
#endif

#define CAT_(A, B) A##B
#define CAT(A, B) CAT_(A, B)

#define ROCC_INSTRUCTION_R_R_R(x, rd, rs1, rs2, func7)                   \
  {                                                                      \
    asm volatile(".insn r " STR(CAT(CUSTOM_, x)) ", " STR(0x7) ", " STR( \
                     func7) ", %0, %1, %2"                               \
                 : "=r"(rd)                                              \
                 : "r"(rs1), "r"(rs2));                                  \
  }

#define ROCC_INSTRUCTION_0_R_R(x, rs1, rs2, func7)                       \
  {                                                                      \
    asm volatile(".insn r " STR(CAT(CUSTOM_, x)) ", " STR(0x3) ", " STR( \
                     func7) ", x0, %0, %1"                               \
                 :                                                       \
                 : "r"(rs1), "r"(rs2));                                  \
  }

/* USER CODE END PM */

/* Private variables ---------------------------------------------------------*/

/* USER CODE BEGIN PV */

/* USER CODE END PV */

/* Private function prototypes -----------------------------------------------*/

/* USER CODE BEGIN PFP */

/* USER CODE END PFP */

/* Private user code ---------------------------------------------------------*/
/* USER CODE BEGIN 0 */

const uint8_t L1_w_p_ptr[32] __attribute__((aligned(8))) = {
    56, 56, 44, 60, 20, 60, 60, 24, 72, 60, 56, 60, 52, 48, 40, 48,
    52, 56, 48, 40, 48, 56, 20, 40, 64, 52, 72, 44, 28, 36, 44, 52};
const uint8_t L1_w_n_ptr[32] __attribute__((aligned(8))) = {
    28, 28, 40, 40, 32, 44, 44, 52, 44, 36, 40, 40, 28, 28, 36, 40,
    28, 32, 40, 20, 40, 48, 28, 44, 32, 56, 36, 28, 32, 56, 24, 44};
const uint8_t L1_w_p_arr[3136] __attribute__((aligned(8))) = {
    1, 17,  1, 32,  1, 35,  1, 36,  1, 37,  1, 39,  1, 41,  1, 52,  1, 60,
    1, 67,  1, 68,  1, 70,  2, 74,  2, 75,  2, 76,  1, 81,  1, 82,  1, 85,
    2, 89,  3, 90,  1, 95,  1, 103, 2, 104, 1, 106, 1, 108, 1, 109, 1, 111,
    2, 117, 1, 118, 1, 121, 1, 125, 1, 130, 1, 131, 1, 132, 1, 134, 1, 135,
    1, 136, 1, 138, 1, 140, 1, 143, 1, 144, 1, 146, 1, 147, 1, 148, 1, 150,
    1, 159, 3, 160, 2, 161, 1, 162, 1, 163, 1, 174, 1, 184, 1, 186, 0, 195,
    0, 195, 0, 195, 1, 5,   1, 7,   1, 8,   1, 12,  1, 20,  1, 21,  1, 26,
    1, 30,  1, 37,  1, 38,  1, 43,  1, 47,  1, 49,  1, 50,  2, 60,  1, 61,
    1, 62,  1, 63,  1, 74,  1, 75,  1, 76,  1, 83,  1, 84,  1, 86,  1, 87,
    1, 94,  1, 95,  1, 96,  1, 103, 1, 109, 1, 110, 1, 113, 2, 117, 1, 121,
    1, 123, 1, 126, 1, 129, 1, 130, 2, 131, 1, 134, 1, 135, 1, 136, 1, 139,
    1, 144, 2, 145, 2, 146, 2, 147, 1, 148, 1, 153, 1, 158, 1, 160, 1, 167,
    1, 172, 1, 175, 1, 189, 1, 195, 1, 2,   1, 5,   1, 6,   1, 19,  1, 42,
    1, 48,  1, 49,  1, 50,  1, 56,  1, 61,  1, 63,  2, 64,  2, 65,  1, 66,
    1, 74,  1, 75,  1, 79,  2, 80,  1, 81,  1, 87,  1, 88,  1, 89,  1, 94,
    2, 95,  1, 97,  2, 101, 1, 103, 1, 109, 1, 112, 1, 114, 1, 116, 1, 117,
    1, 121, 1, 122, 1, 129, 1, 130, 1, 155, 1, 159, 1, 160, 1, 162, 1, 164,
    1, 166, 0, 195, 0, 195, 1, 6,   1, 19,  1, 21,  1, 29,  1, 32,  1, 43,
    1, 44,  1, 45,  1, 46,  1, 47,  1, 48,  2, 49,  1, 50,  1, 58,  1, 62,
    3, 63,  1, 64,  1, 72,  2, 77,  1, 78,  1, 89,  1, 91,  2, 92,  2, 93,
    1, 102, 2, 106, 3, 107, 1, 108, 1, 109, 1, 113, 1, 114, 1, 120, 2, 121,
    2, 122, 1, 127, 1, 128, 1, 133, 1, 134, 2, 135, 1, 136, 1, 142, 1, 146,
    2, 147, 1, 148, 1, 155, 1, 156, 1, 158, 1, 167, 1, 170, 1, 171, 2, 172,
    1, 173, 1, 174, 1, 176, 1, 180, 1, 187, 1, 189, 1, 190, 1, 191, 1, 192,
    1, 0,   1, 3,   1, 63,  1, 65,  1, 69,  1, 77,  1, 87,  1, 105, 1, 134,
    1, 139, 1, 147, 1, 154, 1, 163, 1, 164, 1, 165, 1, 175, 1, 192, 1, 194,
    0, 195, 0, 195, 1, 8,   1, 11,  1, 16,  1, 33,  2, 34,  3, 35,  1, 36,
    1, 37,  1, 38,  1, 41,  2, 46,  2, 47,  1, 48,  1, 51,  1, 52,  1, 53,
    1, 54,  1, 58,  1, 59,  1, 60,  1, 61,  1, 64,  1, 65,  1, 66,  3, 77,
    1, 78,  1, 91,  1, 97,  2, 104, 3, 105, 1, 111, 4, 118, 2, 119, 1, 128,
    2, 129, 1, 130, 1, 131, 2, 132, 1, 133, 1, 137, 1, 138, 1, 142, 2, 143,
    3, 144, 1, 145, 1, 150, 1, 151, 1, 152, 1, 154, 2, 157, 2, 158, 1, 159,
    1, 160, 2, 161, 2, 162, 1, 163, 1, 170, 1, 175, 0, 195, 0, 195, 1, 1,
    1, 5,   1, 11,  1, 25,  1, 47,  1, 53,  1, 58,  1, 59,  2, 60,  1, 61,
    1, 66,  1, 67,  1, 72,  2, 73,  2, 74,  4, 75,  4, 76,  1, 77,  1, 78,
    1, 79,  1, 81,  1, 83,  1, 85,  1, 86,  2, 87,  3, 88,  2, 89,  1, 90,
    1, 91,  2, 92,  1, 93,  1, 94,  1, 95,  1, 100, 2, 101, 1, 105, 2, 106,
    1, 107, 1, 108, 1, 113, 1, 116, 1, 117, 1, 118, 2, 119, 1, 120, 1, 126,
    1, 158, 1, 159, 2, 160, 2, 161, 1, 162, 1, 166, 1, 173, 1, 174, 1, 175,
    1, 176, 1, 180, 1, 185, 1, 187, 0, 195, 1, 3,   1, 7,   1, 38,  1, 39,
    1, 41,  1, 76,  4, 77,  1, 83,  2, 90,  4, 91,  2, 104, 2, 105, 1, 118,
    2, 119, 1, 133, 1, 144, 1, 154, 1, 156, 1, 157, 2, 162, 1, 179, 1, 183,
    0, 195, 0, 195, 1, 1,   1, 4,   1, 6,   1, 12,  1, 13,  1, 15,  1, 21,
    1, 29,  1, 32,  2, 33,  2, 34,  2, 35,  3, 36,  1, 37,  1, 40,  1, 44,
    2, 45,  2, 46,  1, 47,  1, 48,  1, 50,  1, 51,  1, 52,  1, 58,  1, 59,
    1, 63,  1, 64,  2, 65,  1, 66,  1, 71,  1, 76,  1, 77,  1, 78,  1, 79,
    1, 89,  1, 95,  1, 96,  2, 103, 2, 108, 2, 109, 1, 113, 1, 114, 3, 121,
    3, 122, 2, 123, 2, 128, 2, 129, 1, 130, 3, 134, 3, 135, 3, 136, 1, 137,
    1, 142, 2, 143, 3, 144, 4, 145, 3, 146, 3, 147, 4, 148, 2, 149, 1, 156,
    2, 157, 2, 158, 2, 159, 3, 160, 3, 161, 1, 162, 1, 170, 1, 173, 1, 174,
    1, 193, 1, 194, 1, 19,  1, 27,  1, 30,  1, 32,  1, 33,  1, 41,  1, 46,
    1, 48,  1, 52,  1, 54,  1, 57,  1, 58,  1, 59,  1, 60,  2, 61,  1, 62,
    1, 64,  1, 66,  1, 67,  1, 74,  1, 75,  1, 77,  2, 78,  1, 79,  1, 83,
    1, 86,  1, 87,  1, 88,  2, 90,  2, 91,  3, 92,  1, 93,  1, 100, 1, 104,
    2, 105, 3, 106, 1, 107, 1, 118, 2, 119, 3, 120, 1, 122, 1, 126, 1, 140,
    1, 149, 1, 160, 1, 162, 1, 163, 1, 168, 1, 171, 1, 173, 1, 174, 1, 175,
    1, 177, 1, 178, 1, 183, 1, 191, 1, 193, 1, 194, 1, 195, 0, 195, 1, 3,
    1, 5,   1, 14,  1, 23,  1, 38,  1, 46,  1, 50,  1, 60,  2, 61,  1, 62,
    1, 63,  1, 64,  1, 65,  1, 66,  1, 67,  2, 73,  2, 74,  2, 75,  1, 76,
    2, 78,  2, 79,  1, 80,  1, 86,  2, 87,  3, 88,  2, 89,  1, 92,  1, 93,
    1, 94,  1, 96,  1, 98,  1, 101, 1, 102, 1, 103, 2, 106, 1, 107, 1, 108,
    1, 116, 1, 117, 1, 119, 2, 120, 1, 134, 1, 135, 1, 146, 1, 159, 1, 160,
    1, 168, 1, 173, 1, 174, 2, 175, 1, 176, 1, 177, 1, 181, 1, 183, 1, 188,
    1, 194, 1, 1,   1, 13,  1, 19,  1, 21,  1, 31,  1, 33,  1, 34,  1, 35,
    1, 47,  3, 48,  4, 49,  4, 50,  1, 51,  1, 61,  3, 62,  4, 63,  1, 64,
    1, 77,  1, 79,  2, 80,  1, 81,  1, 83,  1, 86,  1, 90,  3, 91,  2, 93,
    1, 94,  3, 104, 1, 105, 2, 117, 1, 118, 1, 123, 1, 125, 1, 126, 1, 129,
    1, 130, 1, 131, 1, 135, 2, 136, 1, 137, 2, 142, 1, 143, 2, 144, 1, 145,
    1, 149, 2, 150, 1, 151, 1, 157, 1, 158, 2, 165, 1, 170, 1, 173, 2, 174,
    1, 176, 1, 177, 1, 187, 1, 191, 1, 193, 0, 195, 0, 195, 1, 10,  1, 20,
    1, 29,  1, 33,  1, 34,  1, 35,  1, 36,  1, 45,  1, 50,  1, 51,  1, 53,
    1, 64,  1, 66,  1, 67,  1, 70,  1, 78,  1, 79,  1, 89,  1, 90,  1, 95,
    1, 100, 1, 102, 1, 103, 2, 104, 1, 111, 1, 121, 1, 124, 1, 125, 2, 128,
    1, 129, 1, 130, 1, 134, 1, 135, 1, 136, 1, 137, 1, 139, 1, 142, 1, 143,
    1, 144, 1, 149, 1, 150, 1, 156, 1, 158, 1, 159, 2, 160, 1, 161, 1, 163,
    1, 164, 1, 167, 0, 195, 0, 195, 0, 195, 1, 3,   1, 7,   1, 15,  1, 20,
    1, 21,  1, 33,  1, 34,  1, 35,  2, 36,  1, 43,  1, 47,  1, 48,  1, 49,
    1, 51,  1, 54,  1, 60,  1, 67,  1, 74,  1, 75,  1, 81,  2, 82,  1, 90,
    1, 91,  1, 94,  1, 95,  1, 103, 2, 104, 2, 105, 1, 116, 2, 117, 1, 118,
    2, 129, 2, 130, 2, 131, 1, 136, 1, 137, 1, 138, 1, 143, 2, 145, 1, 147,
    1, 148, 1, 149, 1, 150, 2, 160, 1, 161, 1, 162, 1, 163, 1, 168, 1, 7,
    1, 15,  1, 19,  1, 23,  1, 24,  1, 29,  1, 31,  1, 37,  1, 38,  1, 48,
    1, 56,  1, 72,  1, 75,  1, 88,  1, 89,  1, 90,  1, 95,  1, 98,  1, 100,
    1, 101, 1, 102, 1, 103, 1, 107, 1, 109, 1, 113, 1, 115, 1, 116, 1, 117,
    1, 120, 1, 129, 1, 130, 1, 131, 1, 133, 1, 134, 1, 135, 1, 145, 1, 146,
    2, 147, 1, 181, 1, 194, 1, 8,   1, 14,  1, 25,  1, 30,  1, 47,  1, 48,
    1, 49,  2, 50,  1, 51,  1, 54,  1, 59,  1, 60,  1, 61,  1, 62,  2, 64,
    2, 65,  2, 67,  1, 71,  1, 75,  1, 76,  1, 78,  2, 79,  1, 80,  1, 81,
    1, 83,  1, 85,  1, 86,  1, 88,  1, 93,  1, 101, 1, 102, 1, 106, 1, 107,
    1, 115, 1, 117, 1, 120, 1, 129, 1, 142, 1, 152, 1, 159, 1, 160, 1, 161,
    1, 164, 1, 174, 1, 175, 1, 180, 1, 190, 0, 195, 1, 6,   1, 7,   1, 13,
    1, 15,  1, 35,  1, 40,  1, 48,  1, 49,  1, 50,  1, 51,  1, 61,  1, 65,
    1, 66,  1, 67,  1, 69,  2, 74,  2, 75,  1, 80,  1, 81,  1, 83,  1, 85,
    1, 87,  1, 88,  1, 89,  1, 90,  1, 94,  1, 95,  2, 102, 1, 103, 1, 104,
    1, 109, 1, 112, 1, 115, 1, 116, 1, 117, 1, 123, 1, 128, 1, 129, 2, 130,
    1, 131, 1, 140, 1, 144, 1, 147, 1, 159, 2, 160, 1, 161, 1, 162, 1, 166,
    1, 169, 1, 178, 1, 179, 1, 180, 1, 1,   1, 30,  1, 41,  1, 45,  1, 46,
    1, 47,  1, 48,  1, 49,  1, 50,  1, 55,  1, 59,  2, 60,  3, 61,  4, 62,
    3, 63,  3, 64,  2, 65,  2, 66,  1, 67,  1, 72,  1, 73,  1, 74,  1, 75,
    1, 76,  2, 78,  1, 79,  2, 80,  1, 81,  1, 82,  1, 86,  1, 94,  1, 96,
    1, 116, 1, 117, 2, 120, 1, 121, 1, 129, 1, 133, 1, 137, 1, 138, 1, 143,
    1, 145, 1, 158, 1, 159, 3, 160, 1, 161, 1, 172, 1, 173, 1, 174, 1, 175,
    1, 176, 1, 178, 1, 182, 1, 186, 1, 189, 1, 190, 1, 7,   1, 15,  1, 26,
    1, 42,  1, 48,  2, 49,  2, 50,  1, 60,  1, 61,  2, 62,  2, 63,  1, 64,
    1, 72,  1, 73,  1, 74,  1, 75,  2, 76,  2, 77,  1, 79,  2, 80,  1, 81,
    1, 83,  1, 90,  3, 91,  1, 92,  1, 93,  1, 94,  1, 95,  2, 105, 1, 107,
    1, 118, 1, 157, 1, 158, 1, 160, 1, 161, 1, 172, 1, 173, 1, 174, 1, 175,
    2, 176, 1, 177, 1, 183, 1, 184, 1, 185, 1, 186, 1, 189, 1, 191, 1, 195,
    1, 2,   1, 7,   1, 13,  1, 29,  1, 34,  1, 35,  1, 42,  1, 49,  1, 59,
    1, 62,  1, 63,  1, 69,  1, 73,  1, 74,  1, 81,  1, 94,  1, 105, 1, 108,
    1, 117, 1, 118, 1, 121, 1, 124, 1, 131, 1, 132, 1, 134, 1, 138, 1, 144,
    2, 145, 1, 146, 1, 147, 1, 149, 1, 156, 1, 160, 1, 161, 1, 162, 1, 168,
    1, 176, 1, 177, 1, 178, 1, 186, 1, 3,   1, 10,  1, 23,  1, 33,  1, 36,
    1, 37,  1, 43,  1, 53,  1, 74,  1, 88,  3, 89,  2, 90,  1, 92,  1, 100,
    1, 101, 3, 102, 3, 103, 3, 104, 2, 105, 2, 106, 1, 107, 1, 112, 2, 115,
    2, 116, 2, 117, 1, 118, 2, 119, 2, 120, 1, 122, 1, 124, 1, 128, 1, 130,
    1, 133, 1, 134, 1, 135, 1, 136, 1, 137, 1, 147, 1, 148, 1, 149, 1, 150,
    1, 151, 1, 161, 1, 163, 1, 165, 1, 181, 0, 195, 0, 195, 1, 11,  1, 14,
    1, 28,  1, 29,  1, 39,  1, 43,  1, 45,  1, 48,  1, 49,  1, 50,  1, 55,
    1, 59,  1, 60,  1, 61,  2, 62,  2, 63,  2, 64,  2, 65,  1, 66,  1, 71,
    1, 72,  1, 75,  1, 78,  1, 79,  1, 80,  1, 83,  1, 92,  1, 93,  1, 100,
    1, 106, 1, 107, 1, 113, 1, 114, 1, 121, 1, 133, 1, 137, 1, 153, 1, 154,
    1, 158, 1, 165, 1, 166, 1, 171, 1, 172, 1, 173, 1, 174, 1, 175, 1, 176,
    1, 177, 1, 181, 1, 185, 1, 186, 1, 189, 1, 191, 0, 195, 0, 195, 0, 195,
    1, 1,   1, 18,  1, 29,  1, 30,  1, 47,  1, 50,  1, 66,  1, 72,  1, 81,
    1, 82,  1, 101, 1, 103, 1, 109, 1, 130, 1, 139, 1, 144, 1, 166, 1, 172,
    1, 183, 1, 187, 1, 12,  1, 13,  1, 23,  1, 35,  1, 36,  1, 38,  1, 39,
    1, 42,  1, 53,  1, 55,  1, 59,  1, 78,  1, 79,  1, 89,  1, 92,  2, 102,
    1, 103, 1, 104, 2, 105, 1, 106, 1, 108, 2, 115, 1, 116, 2, 117, 2, 118,
    3, 119, 1, 130, 2, 131, 2, 132, 1, 133, 1, 134, 1, 145, 1, 149, 1, 150,
    1, 162, 1, 164, 1, 185, 0, 195, 0, 195, 0, 195, 1, 10,  1, 20,  1, 23,
    1, 24,  1, 26,  1, 28,  1, 31,  1, 32,  1, 34,  2, 35,  2, 36,  2, 37,
    1, 39,  1, 60,  1, 61,  1, 69,  1, 71,  1, 88,  1, 89,  1, 90,  1, 92,
    1, 93,  1, 94,  1, 95,  1, 101, 1, 102, 3, 103, 3, 104, 2, 105, 2, 106,
    1, 115, 2, 116, 4, 117, 2, 118, 2, 119, 2, 120, 1, 123, 1, 124, 1, 127,
    1, 128, 1, 129, 2, 130, 4, 131, 4, 132, 1, 133, 2, 134, 1, 135, 1, 136,
    1, 137, 1, 138, 1, 140, 1, 144, 1, 145, 2, 146, 2, 147, 2, 148, 1, 149,
    1, 150, 1, 151, 1, 152, 1, 165, 1, 179, 1, 182, 1, 191, 1, 21,  1, 22,
    1, 28,  1, 36,  1, 37,  1, 39,  1, 62,  1, 73,  1, 74,  2, 75,  1, 76,
    1, 81,  1, 82,  2, 87,  1, 88,  2, 89,  1, 93,  1, 95,  2, 101, 1, 102,
    2, 103, 1, 106, 1, 107, 1, 108, 2, 109, 1, 110, 2, 115, 3, 116, 3, 117,
    1, 118, 1, 120, 1, 121, 1, 122, 2, 130, 2, 131, 1, 132, 2, 133, 1, 134,
    1, 135, 1, 145, 2, 146, 2, 147, 1, 148, 1, 164, 1, 177, 1, 182, 1, 189,
    1, 193, 1, 195, 0, 195, 0, 195, 0, 195, 1, 1,   1, 8,   1, 21,  1, 29,
    1, 30,  1, 32,  1, 33,  1, 34,  1, 35,  1, 43,  1, 44,  1, 47,  3, 48,
    4, 49,  3, 50,  1, 51,  1, 52,  1, 55,  1, 61,  1, 62,  1, 63,  2, 64,
    1, 65,  1, 66,  1, 67,  1, 78,  1, 79,  1, 80,  1, 86,  1, 90,  2, 91,
    1, 92,  1, 93,  1, 94,  1, 97,  1, 103, 2, 104, 1, 105, 2, 106, 1, 114,
    1, 115, 1, 116, 1, 117, 1, 118, 1, 120, 1, 125, 1, 128, 1, 129, 2, 137,
    1, 138, 2, 143, 1, 144, 1, 149, 1, 150, 2, 151, 1, 152, 1, 155, 1, 157,
    1, 159, 1, 160, 1, 162, 2, 163, 2, 164, 1, 167, 1, 173, 1, 174, 1, 179,
    1, 187, 1, 190, 0, 195, 0, 195, 0, 195, 1, 3,   1, 5,   1, 10,  1, 28,
    1, 30,  1, 33,  1, 44,  1, 45,  1, 48,  1, 51,  1, 60,  2, 61,  1, 62,
    3, 63,  2, 64,  2, 65,  2, 66,  1, 71,  1, 72,  1, 75,  2, 78,  2, 79,
    1, 80,  1, 93,  1, 94,  1, 100, 1, 102, 1, 107, 1, 108, 1, 116, 1, 119,
    2, 120, 1, 121, 1, 122, 1, 123, 1, 124, 1, 132, 1, 133, 1, 145, 1, 183,
    1, 187, 1, 194, 1, 195, 0, 195, 1, 7,   1, 17,  1, 39,  1, 51,  1, 52,
    1, 54,  1, 65,  2, 89,  1, 90,  1, 92,  1, 97,  1, 100, 1, 101, 2, 103,
    1, 106, 1, 118, 1, 119, 1, 120, 1, 121, 1, 134, 1, 135, 1, 142, 1, 167,
    1, 171, 1, 172, 1, 188, 1, 195, 0, 195, 1, 4,   1, 6,   1, 11,  1, 15,
    1, 24,  1, 27,  1, 34,  1, 38,  1, 63,  1, 69,  3, 77,  3, 91,  1, 96,
    1, 104, 4, 105, 1, 115, 1, 117, 4, 118, 3, 119, 1, 123, 2, 130, 3, 131,
    4, 132, 2, 133, 1, 144, 2, 145, 2, 146, 2, 147, 1, 155, 1, 162, 1, 166,
    1, 171, 1, 183, 1, 192, 1, 195, 0, 195, 1, 7,   1, 11,  1, 20,  1, 24,
    1, 37,  1, 42,  1, 47,  1, 48,  1, 50,  1, 53,  1, 59,  1, 60,  1, 61,
    1, 63,  1, 65,  1, 67,  1, 73,  1, 74,  1, 75,  2, 76,  2, 80,  1, 89,
    1, 92,  1, 94,  1, 95,  1, 106, 1, 120, 1, 121, 1, 123, 1, 134, 1, 135,
    1, 145, 1, 146, 1, 148, 1, 154, 2, 159, 1, 160, 2, 161, 1, 166, 1, 167,
    1, 172, 1, 174, 1, 185, 0, 195, 1, 4,   1, 6,   1, 10,  1, 16,  1, 38,
    1, 43,  1, 49,  1, 50,  1, 51,  1, 52,  1, 54,  1, 63,  1, 65,  1, 69,
    1, 73,  1, 74,  1, 75,  3, 76,  1, 77,  1, 81,  1, 86,  3, 87,  3, 88,
    3, 89,  4, 90,  3, 91,  1, 92,  1, 93,  1, 94,  2, 95,  2, 101, 1, 102,
    1, 103, 2, 104, 1, 105, 1, 106, 1, 109, 1, 111, 1, 116, 1, 139, 1, 158,
    1, 159, 1, 160, 2, 161, 1, 162, 1, 169, 1, 177, 1, 178, 1, 192, 0, 195,
    0, 195, 0, 195};
const uint8_t L1_w_n_arr[2376] __attribute__((aligned(8))) = {
    1, 5,   1, 20,  1, 40,  1, 49,  1, 57,  3, 63,  3, 64,  1, 65,  1, 69,
    2, 77,  1, 78,  1, 84,  1, 86,  1, 100, 1, 102, 1, 107, 1, 123, 1, 128,
    1, 142, 1, 151, 1, 157, 1, 178, 1, 179, 1, 188, 1, 193, 0, 195, 0, 195,
    0, 195, 1, 2,   1, 3,   1, 14,  1, 16,  1, 53,  1, 65,  1, 78,  1, 82,
    1, 91,  1, 101, 1, 104, 1, 106, 1, 118, 2, 119, 1, 120, 1, 140, 1, 151,
    1, 155, 1, 164, 1, 165, 1, 177, 1, 178, 1, 180, 1, 183, 1, 188, 1, 194,
    0, 195, 0, 195, 1, 0,   1, 11,  1, 20,  1, 21,  1, 22,  1, 25,  1, 36,
    1, 38,  1, 43,  1, 45,  2, 46,  1, 58,  1, 59,  1, 77,  1, 90,  2, 91,
    2, 92,  1, 98,  1, 104, 2, 105, 2, 106, 1, 107, 3, 118, 2, 119, 1, 133,
    1, 135, 1, 141, 1, 142, 1, 148, 1, 156, 1, 167, 1, 168, 1, 171, 1, 178,
    1, 180, 1, 183, 1, 185, 0, 195, 0, 195, 0, 195, 1, 5,   1, 9,   1, 26,
    1, 35,  1, 52,  1, 53,  2, 67,  1, 68,  1, 73,  1, 74,  1, 75,  1, 80,
    2, 81,  1, 95,  1, 110, 1, 115, 2, 116, 2, 117, 2, 118, 1, 124, 3, 130,
    4, 131, 2, 132, 1, 139, 1, 144, 1, 145, 1, 151, 1, 152, 1, 153, 2, 160,
    1, 161, 1, 162, 1, 163, 1, 164, 1, 165, 1, 184, 1, 193, 0, 195, 0, 195,
    0, 195, 1, 11,  1, 14,  1, 20,  1, 22,  1, 27,  1, 33,  1, 38,  1, 45,
    1, 50,  1, 66,  1, 74,  1, 88,  1, 92,  1, 95,  1, 99,  1, 102, 1, 108,
    1, 109, 1, 111, 1, 113, 1, 115, 1, 135, 1, 138, 1, 141, 1, 142, 1, 148,
    1, 150, 1, 155, 1, 158, 1, 178, 1, 185, 1, 191, 1, 0,   1, 2,   1, 7,
    1, 18,  1, 24,  1, 40,  1, 43,  1, 71,  1, 73,  1, 74,  3, 75,  1, 76,
    1, 86,  3, 87,  4, 88,  4, 89,  1, 92,  1, 93,  1, 94,  1, 95,  1, 96,
    1, 100, 3, 101, 2, 102, 2, 103, 1, 106, 1, 107, 1, 109, 1, 115, 1, 116,
    1, 117, 1, 120, 1, 126, 1, 140, 1, 176, 1, 177, 1, 181, 1, 182, 1, 183,
    1, 186, 1, 189, 0, 195, 0, 195, 0, 195, 1, 2,   1, 7,   1, 19,  1, 20,
    1, 21,  1, 22,  1, 31,  1, 32,  1, 33,  1, 34,  1, 35,  1, 45,  1, 46,
    1, 48,  2, 49,  1, 50,  1, 51,  2, 63,  1, 99,  1, 102, 1, 122, 1, 124,
    1, 127, 2, 128, 2, 129, 1, 134, 1, 135, 1, 136, 2, 137, 1, 142, 1, 143,
    1, 144, 1, 145, 1, 148, 1, 149, 2, 150, 1, 151, 1, 152, 1, 157, 1, 165,
    1, 178, 1, 179, 0, 195, 0, 195, 1, 0,   1, 14,  1, 18,  1, 19,  1, 20,
    1, 22,  1, 30,  1, 32,  1, 33,  1, 34,  1, 36,  2, 46,  1, 47,  1, 48,
    1, 50,  1, 58,  1, 59,  2, 60,  2, 61,  1, 74,  1, 75,  1, 80,  1, 86,
    1, 94,  1, 106, 1, 107, 1, 108, 1, 110, 1, 115, 1, 117, 1, 120, 1, 121,
    2, 122, 2, 129, 1, 130, 1, 131, 1, 135, 2, 136, 1, 137, 1, 138, 1, 145,
    1, 149, 1, 150, 1, 152, 1, 160, 1, 169, 1, 174, 1, 175, 1, 178, 1, 184,
    1, 185, 0, 195, 1, 0,   1, 2,   1, 10,  1, 11,  1, 19,  1, 24,  1, 62,
    1, 68,  2, 73,  2, 74,  2, 75,  2, 87,  2, 88,  2, 91,  1, 92,  1, 93,
    1, 94,  1, 100, 1, 101, 2, 105, 3, 106, 2, 116, 3, 117, 2, 118, 3, 119,
    2, 132, 1, 153, 1, 155, 1, 164, 1, 165, 1, 176, 1, 177, 1, 179, 1, 182,
    1, 184, 1, 185, 1, 186, 1, 187, 1, 189, 1, 190, 1, 195, 0, 195, 0, 195,
    0, 195, 1, 2,   1, 4,   1, 10,  1, 17,  1, 21,  1, 25,  1, 26,  1, 34,
    1, 35,  1, 44,  1, 70,  1, 95,  1, 101, 1, 102, 1, 103, 1, 109, 1, 110,
    1, 113, 1, 114, 1, 115, 2, 116, 1, 123, 1, 128, 1, 129, 1, 130, 1, 131,
    1, 132, 1, 137, 1, 144, 2, 145, 1, 146, 1, 150, 1, 158, 1, 182, 1, 192,
    0, 195, 1, 6,   1, 7,   1, 10,  1, 13,  1, 19,  1, 20,  1, 21,  1, 30,
    1, 33,  1, 34,  1, 36,  1, 37,  1, 77,  1, 82,  1, 91,  1, 97,  1, 104,
    1, 105, 1, 118, 1, 128, 1, 129, 1, 130, 1, 131, 1, 132, 1, 133, 2, 136,
    1, 137, 1, 143, 1, 144, 1, 145, 1, 148, 1, 150, 1, 151, 1, 152, 1, 153,
    1, 156, 1, 157, 1, 162, 0, 195, 0, 195, 1, 0,   1, 10,  1, 16,  1, 23,
    1, 24,  1, 25,  1, 37,  1, 38,  1, 40,  1, 41,  1, 42,  1, 45,  1, 53,
    1, 58,  1, 59,  1, 66,  1, 67,  1, 69,  1, 72,  1, 76,  2, 78,  1, 88,
    2, 89,  1, 101, 1, 102, 1, 103, 1, 106, 2, 107, 1, 108, 2, 109, 1, 114,
    1, 119, 1, 121, 1, 122, 1, 140, 1, 141, 1, 152, 1, 153, 1, 164, 1, 183,
    1, 1,   1, 6,   1, 21,  1, 22,  1, 28,  1, 40,  1, 54,  1, 57,  1, 58,
    1, 63,  1, 71,  1, 75,  1, 81,  1, 87,  1, 96,  1, 106, 1, 131, 1, 132,
    1, 138, 1, 146, 1, 153, 1, 169, 1, 171, 1, 175, 1, 176, 1, 177, 0, 195,
    0, 195, 1, 5,   1, 19,  1, 30,  1, 39,  1, 40,  1, 45,  1, 63,  1, 64,
    1, 78,  1, 83,  1, 84,  1, 86,  1, 92,  1, 93,  1, 101, 1, 106, 1, 107,
    1, 108, 1, 113, 1, 121, 1, 125, 1, 141, 1, 152, 1, 169, 1, 171, 1, 172,
    1, 174, 1, 191, 1, 1,   1, 3,   1, 4,   1, 10,  1, 17,  1, 34,  1, 35,
    1, 36,  1, 39,  1, 44,  1, 45,  1, 47,  1, 50,  1, 63,  1, 71,  1, 77,
    1, 78,  1, 79,  1, 80,  1, 97,  1, 119, 2, 143, 1, 153, 1, 154, 1, 158,
    1, 159, 1, 166, 1, 171, 1, 172, 1, 174, 1, 175, 1, 176, 1, 177, 1, 184,
    0, 195, 0, 195, 1, 5,   1, 15,  1, 20,  1, 22,  1, 23,  1, 27,  1, 29,
    1, 32,  1, 33,  1, 34,  1, 35,  1, 36,  1, 37,  1, 38,  1, 43,  1, 55,
    1, 77,  1, 82,  2, 91,  1, 95,  1, 104, 1, 105, 1, 122, 1, 127, 1, 131,
    1, 134, 1, 135, 1, 136, 1, 137, 1, 144, 1, 145, 1, 146, 1, 147, 1, 148,
    1, 153, 1, 158, 1, 171, 1, 182, 1, 188, 1, 195, 1, 14,  1, 21,  1, 22,
    1, 24,  1, 28,  1, 44,  1, 45,  1, 63,  1, 77,  1, 78,  1, 92,  1, 93,
    1, 100, 1, 105, 1, 107, 1, 120, 1, 141, 1, 150, 1, 156, 1, 164, 1, 165,
    1, 171, 1, 183, 1, 187, 1, 190, 1, 193, 1, 194, 0, 195, 1, 4,   1, 7,
    1, 8,   1, 15,  1, 18,  1, 20,  1, 22,  1, 32,  1, 34,  1, 36,  1, 37,
    1, 38,  1, 39,  1, 40,  1, 83,  2, 89,  3, 90,  3, 91,  1, 101, 1, 102,
    1, 103, 3, 104, 2, 105, 1, 122, 1, 134, 1, 135, 1, 136, 2, 147, 1, 149,
    1, 162, 1, 166, 1, 168, 1, 13,  1, 19,  1, 23,  1, 33,  1, 35,  1, 36,
    1, 41,  1, 45,  1, 47,  1, 53,  1, 54,  1, 59,  1, 89,  1, 96,  1, 98,
    1, 102, 2, 103, 1, 108, 1, 113, 1, 115, 1, 116, 1, 121, 1, 123, 1, 124,
    1, 128, 1, 129, 1, 131, 1, 134, 1, 145, 1, 147, 1, 148, 1, 150, 1, 152,
    1, 154, 1, 159, 1, 163, 1, 167, 1, 170, 0, 195, 0, 195, 1, 12,  1, 14,
    1, 18,  1, 22,  1, 51,  1, 53,  1, 87,  1, 88,  1, 89,  1, 100, 1, 101,
    1, 106, 1, 107, 2, 120, 1, 142, 1, 153, 1, 155, 1, 179, 1, 191, 0, 195,
    1, 1,   1, 4,   1, 12,  1, 13,  1, 20,  1, 24,  1, 41,  1, 49,  1, 58,
    1, 59,  1, 60,  1, 61,  1, 62,  1, 63,  1, 64,  1, 65,  1, 68,  1, 71,
    1, 72,  1, 76,  2, 77,  1, 78,  1, 79,  1, 83,  1, 91,  1, 113, 1, 139,
    1, 152, 1, 154, 1, 158, 1, 171, 1, 172, 2, 174, 1, 175, 1, 176, 1, 187,
    1, 190, 1, 195, 0, 195, 0, 195, 1, 1,   1, 2,   1, 8,   1, 9,   1, 20,
    1, 27,  2, 35,  1, 36,  1, 37,  1, 38,  1, 53,  1, 54,  1, 69,  1, 81,
    1, 87,  1, 88,  1, 89,  3, 90,  1, 91,  1, 95,  1, 102, 1, 103, 2, 104,
    1, 105, 1, 111, 1, 117, 1, 118, 1, 122, 1, 127, 1, 128, 1, 129, 1, 130,
    1, 132, 1, 135, 1, 141, 1, 142, 1, 143, 1, 145, 1, 148, 1, 149, 1, 150,
    1, 162, 1, 163, 1, 184, 1, 195, 0, 195, 0, 195, 0, 195, 1, 2,   1, 8,
    1, 21,  1, 24,  1, 25,  1, 40,  1, 42,  1, 59,  1, 67,  1, 76,  1, 91,
    1, 94,  1, 96,  1, 119, 1, 124, 1, 132, 1, 137, 1, 165, 1, 169, 1, 174,
    1, 175, 1, 178, 1, 180, 1, 181, 1, 188, 1, 193, 0, 195, 0, 195, 1, 2,
    1, 15,  1, 19,  1, 20,  1, 28,  1, 29,  1, 48,  2, 49,  1, 50,  1, 51,
    1, 57,  3, 63,  1, 66,  1, 68,  1, 71,  1, 72,  1, 73,  1, 80,  1, 81,
    1, 83,  1, 90,  1, 91,  1, 93,  1, 94,  1, 98,  1, 112, 1, 135, 1, 142,
    1, 143, 1, 153, 1, 159, 1, 160, 1, 161, 1, 165, 1, 172, 1, 173, 2, 174,
    1, 175, 1, 176, 1, 177, 1, 179, 1, 189, 1, 190, 1, 191, 1, 6,   1, 30,
    1, 44,  1, 51,  3, 52,  1, 53,  1, 56,  2, 63,  3, 64,  3, 65,  2, 66,
    2, 67,  1, 76,  4, 77,  2, 78,  1, 79,  1, 91,  1, 141, 1, 157, 1, 158,
    1, 159, 2, 161, 1, 162, 1, 170, 1, 171, 1, 172, 2, 173, 1, 174, 1, 175,
    1, 192, 1, 195, 0, 195, 1, 3,   1, 9,   1, 13,  1, 18,  1, 29,  1, 33,
    1, 34,  1, 35,  1, 45,  1, 48,  2, 51,  1, 52,  1, 55,  1, 57,  1, 63,
    1, 64,  1, 65,  1, 66,  1, 67,  1, 70,  2, 77,  1, 78,  1, 79,  1, 85,
    1, 90,  1, 91,  1, 104, 1, 105, 1, 111, 1, 112, 1, 114, 1, 127, 1, 128,
    1, 129, 1, 141, 1, 142, 1, 143, 1, 150, 1, 158, 1, 160, 1, 162, 1, 163,
    1, 170, 1, 172, 1, 173, 1, 174, 1, 175, 1, 176, 1, 181, 1, 184, 1, 187,
    1, 188, 1, 192, 0, 195, 0, 195, 0, 195, 1, 0,   1, 6,   1, 20,  1, 24,
    1, 26,  1, 27,  1, 37,  1, 38,  1, 59,  1, 69,  1, 70,  1, 73,  1, 74,
    2, 76,  2, 77,  1, 81,  1, 87,  2, 95,  1, 99,  1, 100, 1, 101, 1, 108,
    2, 109, 1, 111, 1, 122, 1, 131, 1, 132, 2, 145, 2, 146, 2, 147, 1, 154,
    1, 161, 1, 185, 1, 189, 0, 195, 0, 195, 1, 2,   1, 18,  1, 27,  1, 29,
    1, 36,  1, 37,  1, 41,  1, 67,  1, 73,  1, 76,  1, 84,  1, 87,  1, 88,
    1, 89,  4, 90,  3, 91,  1, 95,  1, 103, 4, 104, 2, 105, 1, 118, 1, 148,
    1, 149, 1, 154, 1, 156, 1, 160, 1, 161, 1, 163, 1, 14,  1, 21,  1, 22,
    1, 24,  1, 34,  1, 41,  1, 48,  1, 49,  1, 50,  1, 61,  1, 63,  1, 64,
    1, 67,  1, 68,  1, 74,  1, 77,  1, 81,  1, 83,  1, 108, 1, 112, 1, 127,
    1, 130, 1, 131, 1, 145, 1, 146, 1, 161, 1, 162, 1, 175, 1, 192, 0, 195,
    0, 195, 0, 195, 1, 2,   1, 7,   1, 9,   1, 32,  1, 42,  1, 46,  1, 47,
    1, 48,  1, 49,  2, 50,  1, 51,  1, 53,  1, 54,  1, 58,  2, 65,  2, 66,
    2, 67,  1, 68,  1, 73,  1, 75,  2, 79,  1, 80,  1, 87,  2, 88,  3, 89,
    1, 90,  1, 92,  1, 93,  1, 99,  1, 100, 1, 102, 2, 103, 1, 106, 1, 107,
    1, 114, 2, 120, 1, 121, 1, 128, 1, 129, 1, 134, 1, 135, 1, 136, 1, 137,
    1, 142, 1, 149, 1, 150, 1, 151, 1, 154, 1, 159, 2, 160, 1, 165, 1, 173,
    1, 174, 1, 175, 0, 195, 0, 195, 1, 6,   1, 17,  1, 22,  1, 23,  1, 29,
    1, 34,  1, 39,  1, 56,  1, 58,  1, 84,  1, 91,  1, 104, 1, 105, 1, 113,
    1, 124, 1, 133, 1, 138, 1, 151, 1, 158, 1, 169, 1, 175, 1, 191, 1, 194,
    0, 195, 1, 3,   1, 8,   1, 12,  1, 15,  1, 23,  1, 28,  1, 31,  1, 32,
    1, 33,  1, 34,  1, 35,  1, 41,  1, 44,  1, 45,  1, 46,  1, 47,  1, 57,
    1, 58,  1, 59,  1, 60,  1, 70,  1, 84,  1, 112, 1, 113, 1, 119, 1, 125,
    1, 128, 1, 129, 1, 131, 2, 132, 1, 133, 1, 136, 1, 137, 1, 142, 1, 143,
    1, 149, 1, 150, 1, 151, 1, 152, 1, 165, 1, 167, 1, 188, 1, 189, 1, 190};
const uint8_t L2_w_p_ptr[10]
    __attribute__((aligned(8))) = {16, 12, 16, 8, 16, 8, 12, 16, 16, 16};
const uint8_t L2_w_n_ptr[10]
    __attribute__((aligned(8))) = {12, 20, 12, 16, 16, 12, 16, 16, 12, 12};
const uint8_t L2_w_p_arr[272] __attribute__((aligned(8))) = {
    2, 1,  5, 2,  5, 8,  1, 11, 1, 12, 1, 13, 1, 15, 3, 16, 2, 17, 1, 19, 1, 25,
    2, 27, 1, 31, 0, 31, 0, 31, 0, 31, 1, 2,  4, 5,  5, 7,  1, 11, 1, 13, 1, 18,
    1, 19, 1, 23, 6, 29, 1, 31, 0, 31, 0, 31, 1, 4,  4, 5,  2, 8,  2, 11, 1, 12,
    1, 13, 1, 17, 1, 19, 2, 20, 1, 21, 1, 22, 2, 23, 4, 24, 4, 26, 3, 27, 1, 29,
    5, 3,  2, 5,  6, 8,  2, 9,  2, 11, 2, 12, 1, 22, 2, 26, 1, 0,  1, 4,  3, 6,
    1, 7,  1, 9,  2, 10, 1, 14, 1, 15, 4, 20, 1, 22, 3, 23, 2, 24, 2, 25, 3, 28,
    2, 31, 0, 31, 1, 8,  1, 18, 0, 31, 0, 31, 0, 31, 0, 31, 0, 31, 0, 31, 1, 0,
    2, 1,  1, 8,  1, 13, 2, 14, 1, 19, 2, 20, 1, 23, 5, 24, 4, 25, 3, 29, 0, 31,
    1, 2,  1, 3,  2, 5,  3, 6,  2, 9,  3, 10, 2, 15, 5, 17, 1, 18, 1, 19, 4, 21,
    5, 27, 1, 29, 1, 30, 0, 31, 0, 31, 4, 0,  2, 5,  3, 6,  2, 9,  2, 11, 3, 13,
    1, 16, 2, 18, 1, 19, 1, 24, 2, 26, 1, 30, 1, 31, 0, 31, 0, 31, 0, 31, 1, 2,
    2, 3,  1, 7,  2, 9,  3, 10, 4, 11, 2, 15, 1, 17, 3, 18, 2, 21, 3, 26, 1, 27,
    3, 31, 0, 31, 0, 31, 0, 31};
const uint8_t L2_w_n_arr[288] __attribute__((aligned(8))) = {
    1, 0,  3, 3,  2, 5,  2, 6,  1, 7,  4, 9,  2, 18, 1, 23, 2, 24, 1, 26, 3, 29,
    0, 31, 2, 0,  2, 1,  1, 3,  1, 8,  3, 10, 1, 12, 1, 14, 2, 15, 1, 16, 3, 17,
    1, 20, 1, 21, 2, 24, 3, 25, 1, 26, 1, 27, 3, 30, 0, 31, 0, 31, 0, 31, 1, 0,
    2, 3,  5, 6,  3, 7,  1, 9,  3, 10, 1, 14, 1, 16, 3, 18, 2, 30, 6, 31, 0, 31,
    1, 0,  2, 2,  1, 4,  3, 6,  1, 10, 1, 14, 1, 15, 2, 16, 2, 17, 3, 23, 2, 24,
    4, 25, 1, 27, 4, 29, 0, 31, 0, 31, 3, 1,  1, 3,  2, 5,  3, 8,  6, 11, 1, 13,
    2, 17, 2, 18, 2, 19, 1, 21, 1, 27, 2, 29, 1, 30, 0, 31, 0, 31, 0, 31, 1, 1,
    2, 6,  1, 7,  1, 13, 1, 14, 1, 16, 1, 20, 1, 25, 1, 29, 0, 31, 0, 31, 0, 31,
    1, 2,  1, 4,  2, 5,  1, 9,  2, 11, 2, 12, 3, 15, 1, 16, 4, 17, 2, 18, 2, 21,
    1, 22, 4, 26, 1, 27, 0, 31, 0, 31, 3, 0,  1, 1,  1, 4,  2, 7,  3, 11, 2, 12,
    3, 13, 1, 14, 2, 16, 4, 20, 1, 22, 1, 23, 4, 24, 1, 25, 2, 26, 2, 31, 5, 3,
    1, 7,  1, 8,  1, 14, 2, 21, 2, 23, 2, 25, 4, 27, 2, 28, 2, 29, 0, 31, 0, 31,
    3, 0,  6, 5,  6, 8,  1, 12, 1, 13, 1, 14, 1, 16, 1, 19, 2, 23, 1, 29, 1, 30,
    0, 31};

const float L1_b[32] __attribute__((aligned(8))) = {
    -0.21996102, 0.02680125,  0.06465499,  0.40749273, -0.02139925, 0.06114511,
    0.17844151,  0.33464688,  0.26875934,  0.1545577,  0.26635364,  -0.0693506,
    0.01508743,  -0.11577939, 0.11993501,  0.16154365, -0.09921514, 0.18440361,
    0.11081247,  0.08887127,  0.16604227,  0.26086533, 0.02794394,  0.3033326,
    0.07179166,  0.23188311,  -0.11208464, 0.37733203, 0.17358075,  0.53600323,
    0.00633177,  0.20400575};
const float L2_b[10] __attribute__((aligned(8))) = {
    -0.24144834, 0.3960018,   0.03745702, 0.04361735,  0.17572264,
    -0.09629191, -0.02782477, 0.14699028, -0.44779482, 0.01357366};

const uint8_t L1_x_size = 196;
const uint8_t L2_x_size = 32;
const uint8_t out_size = 10;
const uint8_t batch_size = 8;

const float L1_s_x = 0.22135417;
const float L1_s_w = 0.16020206;
const float L2_s_x = 0.9230769;
const float L2_s_w = 0.25272506;

const uint8_t x[1568] __attribute__((aligned(8))) = {
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 3, 0, 0, 2, 0, 2, 0, 0,
    0, 0, 0, 2, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 3, 1, 0, 0, 2, 4, 0, 2, 4, 2, 2,
    0, 4, 3, 0, 4, 3, 2, 4, 0, 3, 2, 2, 4, 1, 2, 1, 0, 3, 1, 1, 0, 0, 0, 0, 0,
    3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0,
    0, 2, 4, 1, 1, 4, 1, 2, 4, 1, 2, 4, 2, 1, 2, 4, 1, 2, 2, 1, 1, 0, 2, 3, 3,
    4, 2, 0, 0, 0, 3, 2, 3, 1, 3, 0, 0, 1, 0, 3, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 3, 0, 1, 4, 0, 0, 0, 0, 1, 3, 4, 2, 0, 2, 0, 0, 0, 2, 3,
    0, 1, 3, 0, 0, 0, 0, 4, 0, 3, 0, 0, 3, 0, 0, 3, 0, 2, 0, 4, 1, 4, 0, 0, 0,
    0, 2, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 1, 3, 4, 0, 0, 0,
    0, 3, 4, 0, 0, 4, 1, 0, 0, 0, 0, 0, 0, 4, 4, 0, 3, 0, 0, 0, 0, 4, 0, 0, 3,
    3, 0, 4, 0, 0, 0, 4, 0, 1, 0, 3, 0, 0, 3, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
    0, 0, 0, 0, 0, 0, 2, 3, 4, 1, 0, 0, 1, 3, 2, 0, 0, 3, 0, 0, 4, 3, 0, 0, 0,
    2, 4, 0, 3, 2, 0, 0, 1, 2, 0, 0, 0, 2, 0, 2, 2, 3, 2, 3, 0, 0, 1, 4, 2, 0,
    2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 4, 4, 0, 0, 0, 2,
    0, 1, 2, 1, 0, 0, 2, 4, 3, 0, 0, 3, 0, 2, 3, 2, 4, 0, 1, 3, 0, 4, 1, 0, 1,
    4, 3, 2, 2, 2, 3, 0, 0, 4, 1, 2, 2, 0, 1, 0, 0, 4, 0, 4, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 4, 1, 4, 0, 0, 3, 0, 0, 0, 3, 4, 0, 0, 3, 2, 3, 0, 4, 3, 0,
    2, 2, 4, 3, 1, 4, 0, 0, 4, 4, 4, 4, 4, 4, 0, 0, 1, 4, 0, 0, 2, 1, 0, 3, 0,
    3, 0, 0, 4, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 1, 3, 0, 4, 0, 0,
    1, 0, 4, 0, 0, 1, 0, 3, 1, 0, 2, 0, 3, 1, 1, 0, 2, 0, 0, 0, 2, 3, 4, 2, 4,
    4, 0, 0, 2, 3, 2, 3, 3, 1, 0, 3, 0, 4, 0, 0, 1, 0, 4, 0, 0, 3, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 3, 0, 2, 0, 0, 4, 0, 2, 3, 1, 4, 0, 1, 3, 1, 4, 3, 2, 4, 0, 4, 2, 2,
    4, 4, 0, 3, 0, 4, 2, 1, 2, 4, 0, 1, 3, 3, 2, 3, 0, 1, 4, 0, 1, 4, 4, 0, 0,
    0, 0, 0, 0, 2, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 4, 1, 0,
    0, 0, 2, 1, 0, 4, 4, 0, 0, 0, 4, 3, 0, 2, 2, 0, 0, 1, 4, 3, 0, 0, 3, 0, 3,
    2, 3, 2, 0, 0, 3, 0, 1, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 1, 0,
    0, 2, 0, 0, 0, 0, 2, 0, 0, 2, 0, 3, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
    0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

const uint8_t y[8] = {3, 8, 6, 9, 6, 3, 8, 2};

const uint32_t dense_matrix_stride = 8;

uint8_t h1_buf_pos[2 * 32 * 8] __attribute__((aligned(8)));
uint8_t h1_buf_neg[2 * 32 * 8] __attribute__((aligned(8)));
uint8_t out_buf_pos[2 * 10 * 8] __attribute__((aligned(8)));
uint8_t out_buf_neg[2 * 10 * 8] __attribute__((aligned(8)));

// Various monkey printing functions because printf is crippled...

void print_array(uint8_t *arr, size_t size) {
  char str[64];
  size_t i = 0;
  while (i < size) {
    sprintf(str, "%d", *(arr + i));
    HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);

    i += 1;
    if (i < size) {
      sprintf(str, ", ");
      HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);
    }
    if ((i % 16) == 0) {
      HAL_UART_transmit(UART0, (uint8_t *)"\n", 1, 100);
    }
  }
  HAL_UART_transmit(UART0, (uint8_t *)"\n", 1, 100);
}

uint8_t print_compare_array(uint8_t *a, uint8_t *b, size_t size) {
  uint8_t incorrect = 0;
  size_t i = 0;
  while (i < size) {
    if (*(a + i) != *(b + i)) {
      HAL_UART_transmit(UART0, (uint8_t *)"X", 1, 100);
      incorrect = 1;
    }
    else
      HAL_UART_transmit(UART0, (uint8_t *)"O", 1, 100);
  }
  HAL_UART_transmit(UART0, (uint8_t *)"\n", 1, 100);
  return incorrect;
}

void print_mnist() {
  char str[64];
  for (size_t i = 0; i < batch_size; i++) {
    sprintf(str, "%d: \n", y[i]);
    HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);
    
    for (int j = 0; j < L1_x_size; j++) {
      uint8_t curr = *(x + i + j * batch_size);
      if (curr == 0)
        HAL_UART_transmit(UART0, (uint8_t *)"  ", 2, 100);
      else if (curr == 1)
        HAL_UART_transmit(UART0, (uint8_t *)"--", 2, 100);
      else if (curr == 2)
        HAL_UART_transmit(UART0, (uint8_t *)"++", 2, 100);
      else if (curr == 3)
        HAL_UART_transmit(UART0, (uint8_t *)"##", 2, 100);
      else if (curr >= 4)
        HAL_UART_transmit(UART0, (uint8_t *)"@@", 2, 100);
      
      if (j % 14 == 0) {
        HAL_UART_transmit(UART0, (uint8_t *)"\n", 1, 100);
      }
    }
    HAL_UART_transmit(UART0, (uint8_t *)"\n", 1, 100);
  }
  HAL_UART_transmit(UART0, (uint8_t *)"\n", 1, 100);
}

// [10x8]=[10x32][32x196][196x8]
uint8_t uint_matmul(const uint8_t *w_ptr, const uint8_t *w_arr,
                const uint8_t *x_arr, uint8_t *output,
                size_t w_ptr_size, size_t batch_size) {
  // Assume batch size of 8
  size_t dense_matrix_size = batch_size / dense_matrix_stride;
  /*
  printf("dense_matrix_size:");
  print_char((unsigned char)dense_matrix_size);
  printf("\n");
  */

  // int sparse_row_size = 4;// WARNING SKIP THE ZEROS IT MIGHT CAUSE HELLACACHE
  // ERROR

  uint8_t *internal_w_arr = (uint8_t *)w_arr;
  uint32_t casted_w_ptr;
  uint8_t *output_ptr = output;

  for (size_t i=0; i<w_ptr_size; i+=1) {
    /*
    printf("int i = ");
    print_int(i);
    printf("; i < ");
    print_int(w_ptr_size);
    printf("; w_ptr[i] = ");
    print_int((int)(w_ptr[i]));
    printf("\n");
    */
    /* EXPLICITLY MASK THE REGISTER SO THAT IT ONLY HAS INT8 ELEMENTS MAX
        DO NOT USE (int)w_ptr[i] IT READS THE REST OF THE ELEMENTS IN PACKED
       ARRAY AND SENDS ALL 64 BITS OVER, IT WILL OVERFLOW QUICKLY
    */
    casted_w_ptr = (uint8_t)w_ptr[i];

    asm volatile("fence");
    ROCC_INSTRUCTION_0_R_R(0, internal_w_arr, casted_w_ptr, 0);
    ROCC_INSTRUCTION_0_R_R(0, x_arr, dense_matrix_size, 1);
    ROCC_INSTRUCTION_0_R_R(0, output_ptr, output_ptr, 2);
    asm volatile("fence");
    // Parallely compute on CPU to check results
    /*
    for (int k = 0; k < batch_size; k++) {
      unsigned char result = 0;
      for (int j = 0; j < w_ptr[i]; j++) {
        result += internal_w_arr[j*2] * (*(x_arr + internal_w_arr[1 +
    j*2]*batch_size + k));

        print_int(result);
        printf("=");
        print_int(internal_w_arr[j*2]);
        printf(" * ");
        print_int((*(x_arr + internal_w_arr[1 + j*2]*batch_size + k)));
        printf("\n");

      }
      //printf("batch finished \n");
      *(output + w_ptr_size*batch_size + i*batch_size + k) = result;
    }
    */

    internal_w_arr = internal_w_arr + (w_ptr[i] * 2);
    output_ptr = output_ptr + batch_size;
  }
  /*
  printf("\nw_ptr[0]=");
  print_char(w_ptr[0]);
  printf("\nw_arr[0]=");
  print_char(w_arr[0]);
  printf("\nx_arr[0]=");
  print_char(x_arr[0]);
  printf("\nx_arr[1]=");
  print_char(x_arr[1]);
  printf("\n");
  */

  char str[64];
  sprintf(str, "Accelerator result:\n");
  HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);
  asm volatile("fence");
  print_array(output, w_ptr_size * batch_size);
  /*
  printf("CPU result:\n");
  print_array(output + w_ptr_size*batch_size, w_ptr_size*batch_size);
  printf("Compare bits:\n");
  print_compare_array(output, output+w_ptr_size*batch_size,
  w_ptr_size*batch_size);
  */

  return 0;
}

/*  https://stackoverflow.com/questions/70382318/ex-without-math-h?noredirect=1&lq=1
    e^x
    Actually for inference we don't care about relative probability, just the
max. double fabs1(double x) { if(x >= 0){ return x; } else { return x*(-1);
    }
}

double powerex(double x) {
    double a = 1.0, e = 0;
    int invert = x<0;
    x = fabs1(x);
    for (int n = 1; e != e + a ; ++n) {
        e += a;
        a = a * x / n;
    }
    return invert ? 1/e : e;
}
*/

uint8_t round_float(float n) {
  return (uint8_t)((n > 0) ? (n + 0.5) : (n - 0.5));
}

/*
Quantize and scales every thing properly going into the second layer.
Writes the back to the positive buffer.
Either activates with relu6 or directly searches maximum of float output.
*/
void float_covfefe(uint8_t *pos, uint8_t *neg, const float *bias,
                  size_t size, const float pre_scale, const float post_scale,
                  size_t activate) {
  char str[128];

  for (size_t j = 0; j < 8; j++) {
    float max = 1.175494351e-38;
    uint8_t max_idx = 0;
    for (size_t i = 0; i < size; i++) {
      float curr = ((float)(((int32_t)((uint8_t)*(pos + i * 8 + j))) -
                            ((int32_t)((uint8_t)*(neg + i * 8 + j)))));
      curr = (curr * pre_scale) + bias[i];
      if (activate == 1 && curr < 0.0) curr = 0.0;
      if (activate == 1 && curr > 6.0) curr = 6.0;
      // +0.5 so it rounds properly, c by default just truncates
      if (activate == 0) {
        sprintf(str, "%f, ", curr);
        HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);

        *(pos + i * 8 + j) = 0;
        if (max < curr) {
          max = curr;
          max_idx = (uint8_t)i;
        }
      }
      else {
        *(pos + i * 8 + j) = round_float(curr / post_scale);
      }
    }
    if (activate == 0) {
      // printf("pointer = ");
      // print_pointer(pos+j);
      // printf("\n");
      //*(pos+j) = y[j];
      *(pos + j) = max_idx;
      sprintf(str, "max_idx = %d\n", max_idx);
      HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);
    }
  }
}

/* List of const variables
uint8_t L1_w_p_ptr[196]
uint8_t L1_w_n_ptr[196]
uint8_t L1_w_p_arr[2928]
uint8_t L1_w_n_arr[2424]
uint8_t L2_w_p_ptr[32]
uint8_t L2_w_n_ptr[32]
uint8_t L2_w_p_arr[320]
uint8_t L2_w_n_arr[312]
float L1_b[32]
float L2_b[10]
uint8_t L1_x_size
uint8_t L2_x_size
uint8_t out_size
uint8_t batch_size
float L1_s_x
float L1_s_w
float L2_s_x
float L2_s_w
uint8_t x[1960]
uint8_t y[8]

Normal variables
uint8_t h1_buf_pos[2][32][8] __attribute__ ((aligned (64)));
uint8_t h1_buf_neg[2][32][8] __attribute__ ((aligned (64)));
uint8_t out_buf_pos[2][10][8] __attribute__ ((aligned (64)));
uint8_t out_buf_neg[2][10][8] __attribute__ ((aligned (64)));


int uint_matmul(const uint8_t* w_ptr, const uint8_t* w_arr, const
uint8_t* x_arr, uint8_t* output, int w_ptr_size, int batch_size)
*/
/* USER CODE END 0 */

/**
 * @brief  The application entry point.
 * @retval int
 */
int main(void) {
  /* USER CODE BEGIN 1 */

  /* USER CODE END 1 */

  /* MCU Configuration--------------------------------------------------------*/

  /* USER CODE BEGIN Init */

  /* USER CODE END Init */

  /* Configure the system clock */
  HAL_RCC_InitSystemClock();

  /* USER CODE BEGIN SysInit */

  /* USER CODE END SysInit */

  /* Initialize all configured peripherals */
  UART_InitTypeDef UART_init_config;
  UART_init_config.baudrate = 115200;
  UART_init_config.mode = UART_MODE_TX_RX;
  UART_init_config.stopbits = UART_STOPBITS_1;
  HAL_UART_init(UART0, &UART_init_config);

  /* USER CODE BEGIN 2 */

  /* USER CODE END 2 */

  /* Infinite loop */
  /* USER CODE BEGIN WHILE */

  while (1) {
    char str[128];

    sprintf(str, "MNIST Data Check:\n");
    HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);

    print_mnist();
    uint64_t begin_time = CLINT->MTIME;

    sprintf(str, "L1 Matmul Positive...\n");
    HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);

    uint_matmul(L1_w_p_ptr, L1_w_p_arr, x, h1_buf_pos, L2_x_size, batch_size);

    sprintf(str, "L1 Matmul Negative...\n");
    HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);

    uint_matmul(L1_w_n_ptr, L1_w_n_arr, x, h1_buf_neg, L2_x_size, batch_size);

    sprintf(str, "rescaling and requantizing...\n");
    HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);

    float_covfefe(h1_buf_pos, h1_buf_neg, L1_b, L2_x_size, L1_s_x * L1_s_w, L2_s_x, 1);

    sprintf(str, "Array:\n");
    HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);

    print_array(h1_buf_pos, (uint32_t)L2_x_size * (uint32_t)batch_size);

    sprintf(str, "L2 Matmul Positive...\n");
    HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);

    uint_matmul(L2_w_p_ptr, L2_w_p_arr, h1_buf_pos, out_buf_pos, out_size, batch_size);

    sprintf(str, "L2 Matmul Negaitve...\n");
    HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);

    uint_matmul(L2_w_n_ptr, L2_w_n_arr, h1_buf_pos, out_buf_neg, out_size, batch_size);

    sprintf(str, "rescaling and finding max...\n");
    HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);

    float_covfefe(out_buf_pos, out_buf_neg, L2_b, out_size, L2_s_x * L2_s_w, 0.0, 0);
    uint64_t cycles_taken = CLINT->MTIME - begin_time;

    sprintf(str, "Cycles taken = %lu\n", cycles_taken);
    HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);

    int32_t correct_count = 0;

    sprintf(str, "Checking predictions...\n");
    HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);

    for (size_t i=0; i<8; i+=1) {
      sprintf(str, "label=%d; pred=%d\n", y[i], *(out_buf_pos + i));
      HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);

      // printf("; pointer=");
      // print_pointer(out_buf_pos + i);

      correct_count += (y[i] == *(out_buf_pos + i)) ? 1 : 0;
    }

    sprintf(str, "Correct count: %d\n", correct_count);
    HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);

    if (correct_count == 8) {
      sprintf(str, "Test passed!\n");
      HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);
      // return 0;
    }
    else {
      sprintf(str, "Test failed!\n");
      HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 100);
      // return 1;
    }

    HAL_delay(1000);
    /* USER CODE END WHILE */
  }

  /* USER CODE BEGIN 3 */

  /* USER CODE END 3 */
}

// int _write(int handle, char *data, int size) {
//   int count;
//   char str[128];
//   sprintf(str, "hello\n");
//   HAL_UART_transmit(UART0, (uint8_t *)str, strlen(str), 1000);
//   handle = handle;  // unused
//   // for( count = 0; count < size; count++) {
//   //     // outputByte( data[count] ) ;  // Your low-level output function here.
//   // }
//   return size;
// }
